---
title: init
sidebar_position: 3
---

# bellwether init

Create a `bellwether.yaml` configuration file for testing an MCP server.

## Synopsis

```bash
bellwether init [server-command] [args...]
bellwether init --preset <preset> [server-command]
bellwether init --full [server-command]
```

## Description

The `init` command creates a `bellwether.yaml` configuration file in the current directory. This file controls all aspects of how Bellwether tests your MCP server.

By default, Bellwether initializes for **structural mode** (free, fast, deterministic). Use `--full` or `--preset` to enable LLM-powered testing.

## Arguments

| Argument | Description |
|:---------|:------------|
| `[server-command]` | Command to start the MCP server (e.g., `npx @mcp/server`) |
| `[args...]` | Arguments to pass to the server command |

## Options

| Option | Description | Default |
|:-------|:------------|:--------|
| `-f, --force` | Overwrite existing config file | `false` |
| `--full` | Initialize for full LLM mode | `false` |
| `-p, --preset <name>` | Use a preset configuration | - |
| `--provider <provider>` | LLM provider for full mode | `ollama` |
| `-y, --yes` | Skip prompts, use defaults | `false` |

## Presets

Presets configure Bellwether for common use cases:

| Preset | Mode | Provider | Description |
|:-------|:-----|:---------|:------------|
| `ci` | Structural | - | Fast, free, deterministic - perfect for CI/CD |
| `local` | Full | Ollama | LLM testing with local Ollama (free) |
| `security` | Full | OpenAI | Security-focused multi-persona testing |
| `thorough` | Full | OpenAI | Comprehensive testing with all personas |

## Examples

### Default Structural Mode (Free)

```bash
# Initialize with server command
bellwether init npx @modelcontextprotocol/server-filesystem /tmp

# Or just initialize, add server later
bellwether init
```

Creates `bellwether.yaml` configured for structural mode - fast, free, and deterministic.

### CI/CD Preset

```bash
bellwether init --preset ci npx your-server
```

Optimized for CI/CD pipelines with `failOnDrift: true`.

### Local LLM Testing (Free)

```bash
bellwether init --preset local npx your-server
```

Uses local Ollama for free LLM-powered testing. Requires Ollama running:

```bash
ollama serve
ollama pull llama3.2
```

### Security-Focused Testing

```bash
bellwether init --preset security npx your-server
```

Enables security persona with comprehensive vulnerability testing.

### Comprehensive Testing

```bash
bellwether init --preset thorough npx your-server
```

All personas, workflow discovery, and maximum coverage.

### Full Mode with Specific Provider

```bash
bellwether init --full --provider openai npx your-server
bellwether init --full --provider anthropic npx your-server
```

### Overwrite Existing Config

```bash
bellwether init --force npx your-server
```

## Generated Configuration

The generated `bellwether.yaml` includes all possible options with comments:

```yaml
# Bellwether Configuration
# Generated by: bellwether init

# =============================================================================
# SERVER
# =============================================================================
server:
  command: "npx @modelcontextprotocol/server-filesystem"
  args:
    - "/tmp"
  timeout: 30000

# =============================================================================
# TEST MODE
# =============================================================================
# structural: Fast, free, deterministic - compares tool schemas only
# full: Uses LLM to generate intelligent test scenarios
mode: structural

# =============================================================================
# LLM SETTINGS (full mode only)
# =============================================================================
llm:
  provider: ollama
  model: ""
  ollama:
    baseUrl: "http://localhost:11434"

# =============================================================================
# TEST SETTINGS (full mode only)
# =============================================================================
test:
  personas:
    - technical_writer
  maxQuestionsPerTool: 3
  parallelPersonas: false
  skipErrorTests: false

# =============================================================================
# OUTPUT
# =============================================================================
output:
  dir: "."
  format: both
  cloudFormat: false

# =============================================================================
# BASELINE
# =============================================================================
baseline:
  failOnDrift: false
  minConfidence: 0
  confidenceThreshold: 80

# =============================================================================
# CACHE
# =============================================================================
cache:
  enabled: true
  dir: ".bellwether/cache"

# =============================================================================
# LOGGING
# =============================================================================
logging:
  level: info
  verbose: false
```

## Two Testing Modes

### Structural Mode (Default)

- **Cost**: Free
- **Speed**: Fast
- **Determinism**: 100% reproducible
- **What it tests**: Tool schemas, parameter types, descriptions

Best for CI/CD pipelines and quick checks.

### Full Mode

- **Cost**: ~$0.01-0.15 per run (depends on model and tool count)
- **Speed**: Slower (LLM inference)
- **Determinism**: LLM-generated scenarios may vary
- **What it tests**: Behavioral observations, edge cases, security, usability

Best for thorough testing and documentation generation.

## Environment Variables

If your MCP server requires environment variables (API keys, tokens, URLs), add them to the `server.env` section using interpolation syntax:

```yaml
server:
  command: "npx @your/mcp-server"
  env:
    # Reference environment variables from shell or .env file
    API_KEY: "${API_KEY}"
    SERVICE_URL: "${SERVICE_URL}"

    # With default values
    LOG_LEVEL: "${LOG_LEVEL:-info}"
    DEBUG: "${DEBUG:-false}"
```

The `${VAR}` syntax pulls values from your environment (shell exports or `.env` file loaded via dotenv). This allows you to commit `bellwether.yaml` to version control without exposing secrets.

:::tip
Use `${VAR:-default}` syntax to provide fallback values when an environment variable isn't set.
:::

## Next Steps After Init

```bash
# 1. Run your first test
bellwether test

# 2. Review generated documentation
cat AGENTS.md

# 3. Save a baseline for drift detection
bellwether baseline save

# 4. Compare against baseline in CI
bellwether baseline compare ./bellwether-baseline.json --fail-on-drift
```

## See Also

- [test](/cli/test) - Run tests using configuration
- [baseline](/cli/baseline) - Manage baselines for drift detection
- [Configuration Guide](/guides/configuration) - Full configuration reference
- [Custom Personas](/guides/custom-personas) - Creating custom personas
